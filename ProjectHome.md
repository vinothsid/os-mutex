mutex and condition variable implementation